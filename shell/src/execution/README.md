# Executor Component Documentation

## Overview

The executor component is responsible for executing the Abstract Syntax Tree (AST) generated by the parser. It handles:
- Command execution
- Pipeline management
- Redirection handling
- Builtin commands
- Signal handling
- Process management
- Environment variable handling

## Core Components

### 1. Main Executor

```c
void executor(t_ast_cmd *tree, bool forked)
```

The main executor function that recursively processes the AST:
- Handles different node types (PIPE, AND, OR, EXEC, REDIR, SUBSH)
- Manages process forking
- Controls execution flow
- Maintains exit status

### 2. Command Types

```c
typedef enum {
    P_PIPE,    // Pipeline node
    P_AND,     // Logical AND
    P_OR,      // Logical OR
    P_EXEC,    // Command execution
    P_REDIR,   // Redirection
    P_SUBSH    // Subshell
} t_node_type;
```

## Command Execution

### 1. Simple Commands

```c
void exec_exe(t_ast_exec *exe, bool forked)
```

Features:
- Path resolution
- Builtin command handling
- Environment variable expansion
- Argument processing
- Exit status management

### 2. Pipeline Management

```c
void exec_pipe(t_ast_binary *tree, bool forked)
```

Capabilities:
- Process creation
- Pipe creation and management
- File descriptor handling
- Signal handling in pipes
- Exit status propagation

### 3. Redirection Handling

```c
void exec_redir(t_ast_redir *tree, bool forked)
```

Features:
- File opening and creation
- Permission handling
- File descriptor manipulation
- Error handling

## Examples

### 1. Simple Command Execution

```bash
# Command: ls -l
Process:
1. Expand arguments
2. Check for builtin
3. Search in PATH
4. Execute command
5. Wait for completion
6. Set exit status
```

### 2. Pipeline Execution

```bash
# Command: ls | grep .txt | wc -l
Process:
1. Create pipe fds
2. Fork processes
3. Setup pipe connections
4. Execute commands
5. Wait for completion
6. Handle exit status
```

### 3. Redirection

```bash
# Command: echo "hello" > file.txt
Process:
1. Open/create file
2. Backup original fd
3. Redirect output
4. Execute command
5. Restore original fd
```

## Error Handling

### 1. Command Errors

```c
int execute_cmd(char **cmd, t_env *env)
```

- Command not found
- Permission denied
- Directory execution attempts
- PATH resolution failures

### 2. File Operation Errors

```c
static int open_redir_file(t_ast_redir *tree, char *file_name, bool forked)
```

- File not found
- Permission issues
- File descriptor limits
- Directory checks

### 3. Process Errors

- Fork failures
- Pipe creation errors
- Memory allocation failures
- Signal handling errors

## Signal Handling

### 1. Default Handlers

```c
void reset_default_sig_handlers(void)
```

- SIGINT handling
- SIGQUIT handling
- Terminal control

### 2. Process Groups

- Foreground process management
- Background process handling
- Signal propagation

## Memory Management

### 1. Resource Cleanup

```c
void free_list(char **list)
```

- Argument list cleanup
- File descriptor closure
- Process cleanup
- Memory deallocation

### 2. Process Management

- Fork management
- Pipe cleanup
- File descriptor tracking
- Exit status handling

## Environment Handling

### 1. Environment Variables

```c
char *find_path(t_env *envp)
```

- PATH resolution
- Variable expansion
- Environment modification
- Shell variables

### 2. Working Directory

- Directory validation
- Path resolution
- Current directory tracking

## Usage Guidelines

1. **Command Execution**
   - Validate commands before execution
   - Handle builtin commands first
   - Check file permissions
   - Manage process forking

2. **Pipeline Management**
   - Close unused file descriptors
   - Handle pipe errors gracefully
   - Manage process synchronization
   - Track exit statuses

3. **Error Handling**
   - Check system call returns
   - Handle memory allocation failures
   - Manage file operations
   - Process command errors

4. **Signal Management**
   - Reset handlers in child processes
   - Handle terminal signals
   - Manage process groups
   - Control interactive signals
